/********************************************************************************************************************

  IncludedCACertificateReportController is a controller for IncludedCACertificateReport, IncludedCACertificateReportCSVFormat
  and IncludedCACertificateReportPEMCSV VF pages to list root certificates. Report name used is
  'Mozilla Included CA Certificate List'. 
  
 *********************************************************************************************************************/

public class IncludedCACertificateReportController{

 public List<Account> accountSoLst {get;set;}
 
  // constructor method for standard controller
    public IncludedCACertificateReportController() {   
                                          
           accountSoLst =  [select  Parent.Name,
                                    Certificate_Issuer_Organization__c,
                                    Certificate_Issuer_Organizational_Unit__c,
                                    Name,
                                    SHA_256_Fingerprint__c, 
                                    Certificate_ID__c, 
                                    Certificate_Serial_Number__c,                                                                
                                    Valid_From_YYYY_MMM_DD__c,
                                    Valid_To_YYYY_MMM_DD__c,
                                    Public_Key_Algorithm__c,
                                    Signature_Hash_Algorithm__c,
                                    Trust_Bits__c,
                                    EV_Policy_OID_s__c, 
                                    Approval_Bug__c,
                                    NSS_Release_When_First_Included__c,
                                    Firefox_Release_When_First_Included__c,
                                    Test_Website_Valid__c,
                                    Mozilla_Applied_Constraints__c, 
                                    Parent.Company_Website__c,
                                    Parent.Geographic_Focus__c,
                                    Certificate_Policy_CP__c,
                                    Certification_Practice_Statement_CPS__c,
                                    Standard_Audit__c,
                                    BR_Audit__c, 
                                    EV_Audit__c,
                                    Auditor_New__r.Name,
                                    Standard_Audit_Type__c,
                                    Standard_Audit_Statement_Dt__c,
                                    X_509_Certificate_PEM__c,
                                    Comments__c  
                                          from  Account
                                          where Status__c In ('Included','Change Requested') and RecordType.Name In ('Root Certificate')
                                          order by Parent.Name, Name];
     
 
     
     }
  
     
     String CurrentDate = ' ';
 
    // Get current Datetime in long date format   

    public String getCurrentDate() {

      Datetime cDT = System.now();
      CurrentDate = cDT.format('MMMM d, yyyy');

      return CurrentDate;

   }

     
  }